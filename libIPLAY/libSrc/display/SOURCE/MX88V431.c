/*
// define this module show debug message or not,  0 : disable, 1 : enable
*/
#define LOCAL_DEBUG_ENABLE 0

#include "global612.h"
#include "mpTrace.h"

#if ((TCON_ID == TCON_MX88V431) ||(TCON_ID == TCON_MX88V431_WQVGA))
#define CLK_LO          0xfffffffe
#define CLK_HIGH        0x00000001
#define DATA_LO         0xfffffffd
#define DATA_HIGH   0x00000002

#if ((CHIP_VER & 0xffff0000) == CHIP_VER_600)   //ID1 is high
#define IIC_WRITE_ID          0x28
#define IIC_READ_ID          0x29
#else   //ID1 is low
#define IIC_WRITE_ID          0xA8
#define IIC_READ_ID          0xA9
#endif

#define IIC_NO_ACK      1
#define START               3
#define STOP                4
#define IGNORE              5

// index, value, index, value .....
DWORD RegValue;

//jes modify for delta panel CPH1/2/3, from spike
//0x60, 0xE0 to 0x00, MP600-216PQFP have a bug issue.

//MX88v431
BYTE v431_CCIR656_720x480reg[]=
{
0x00,0x99,0x01,0x07,0x02,0x03,0x03,0x10,0x04,0x00,0x05,0x06,0x06,0xE7,0x07,0x69,
0x08,0x00,0x09,0x10,0x0A,0x00,0x0B,0x06,0x0C,0x06,0x0D,0x06,0x0E,0x06,0x0F,0x06,
0x10,0x80,0x11,0xF4,0x12,0x80,0x13,0x80,0x14,0x80,0x15,0x80,0x16,0x80,0x17,0x80,
0x18,0x80,0x19,0x00,0x1A,0xE0,0x1B,0x38,0x1C,0x80,0x1D,0x00,0x1E,0x00,0x1F,0x00,
0x20,0x40,0x21,0xFF,0x22,0x00,0x23,0x00,0x24,0x18,0x25,0x18,0x26,0x18,0x27,0xF0,
0x28,0xF0,0x29,0xF0,0x2A,0xF0,0x2B,0xF0,0x2C,0xF0,0x2D,0xF0,0x2E,0xF0,0x2F,0xF0,
0x30,0x20,0x31,0x46,0x32,0x00,0x33,0x15,0x34,0x00,0x35,0x47,0x36,0x00,0x37,0x04,
0x38,0x00,0x39,0x09,0x3A,0x00,0x3B,0x1E,0x3C,0x00,0x3D,0x11,0x3E,0x00,0x3F,0x17,
0x40,0x00,0x41,0x11,0x42,0x00,0x43,0x17,0x44,0x00,0x45,0xc5,0x46,0x00,0x47,0xE7,
0x48,0x00,0x49,0x00,0x4A,0x00,0x4B,0x00,0x4C,0x08,0x4D,0x00,0x4E,0x00,0x4F,0x06,
0x50,0x00,0x51,0x30,0x52,0x00,0x53,0x13,0x54,0x00,0x55,0x14,0x56,0x00,0x57,0x13,
0x58,0x00,0x59,0x14,0x5A,0x00,0x5B,0x01,0x5C,0x00,0x5D,0x32,0x5E,0x00,0x5F,0x01,
0x60,0xE0,0x61,0xB0,0x62,0x00,0x63,0x0F,0x64,0x00,0x65,0x31,0x66,0x00,0x67,0x01,
0x68,0x10,0x69,0x20,0x6A,0x00,0x6B,0x60,0x6C,0x00,0x6D,0xA0,0x6E,0x00,0x6F,0xF0,
0x70,0x00,0x71,0x0B,0x72,0x09,0x73,0x0B,0x74,0x9C,0x75,0x00,0x76,0x70,0x77,0x00,
0x78,0x8F,0x79,0x00,0x7A,0xA4,0x7B,0x00,0x7C,0x00,0x7D,0x00,0x7E,0x1D,0x7F,0x40,
0x80,0x06,0x81,0x00,0x82,0x10,0x83,0x00,0x84,0x13,0x85,0x00,0x86,0x00,0x87,0x00,
0x88,0x00,0x89,0x00,0x8A,0x57,0x8B,0x00,0x8C,0x00,0x8D,0x00,0x8E,0x00,0x8F,0x00,
/*0x90,0x40,0x91,0x00,0x92,0x00,0x93,0x00,0x94,0x00,0x95,0x00,0x96,0x00,0x97,0x00,
0x98,0x80,0x99,0xFF,0x9A,0x80,0x9B,0xFF,0x9C,0x80,0x9D,0xFF,0x9E,0x80,0x9F,0xFF,
0xA0,0x40,0xA1,0x00,0xA2,0x00,0xA3,0x00,0xA4,0x80,0xA5,0xFF,0xA6,0x80,0xA7,0xFF,
0xA8,0x00,0xA9,0x00,0xAA,0x00,0xAB,0x00,0xAC,0x80,0xAD,0xFF,0xAE,0x80,0xAF,0xFF,
0xB0,0x40,0xB1,0x00,0xB2,0x80,0xB3,0xFF,0xB4,0x00,0xB5,0x00,0xB6,0x80,0xB7,0xFF,
0xB8,0x00,0xB9,0x00,0xBA,0x80,0xBB,0xFF,0xBC,0x00,0xBD,0x00,0xBE,0x80,0xBF,0xFF,
0xC0,0x02,0xC1,0x00,0xC2,0x02,0xC3,0x02,0xC4,0x02,0xC5,0x02,0xC6,0x02,0xC7,0x02,
0xC8,0x02,0xC9,0x02,0xCA,0x02,0xCB,0x02,0xCC,0x02,0xCD,0x02,0xCE,0x02,0xCF,0x02,
0xD0,0x02,0xD1,0x02,0xD2,0x02,0xD3,0x02,0xD4,0x02,0xD5,0x02,0xD6,0x02,0xD7,0x02,
0xD8,0x02,0xD9,0x02,0xDA,0x02,0xDB,0x02,0xDC,0x02,0xDD,0x02,0xDE,0x02,0xDF,0x02,
0xE0,0x02,0xE1,0x02,0xE2,0x02,0xE3,0x02,0xE4,0x02,0xE5,0x02,0xE6,0x02,0xE7,0x02,
0xE8,0x02,0xE9,0x02,0xEA,0x02,0xEB,0x02,0xEC,0x02,0xED,0x02,0xEE,0x02,0xEF,0x02,
0xF0,0x02,0xF1,0x02,0xF2,0x02,0xF3,0x02,0xF4,0x02,0xF5,0x02,0xF6,0x02,0xF7,0x02,
0xF8,0x02,0xF9,0x02,0xFA,0x02,0xFB,0x02,0xFC,0x02,0xFD,0x02,0xFE,0x02,0xFF,0x02,
*/
0xFF,0xFF};

BYTE v431_CCIR656_LG_720x480reg[]=
{
#if 0
0x00,0x99,0x01,0x07,0x02,0x03,0x03,0x65,0x04,0x06,0x05,0x06,0x06,0xE7,0x07,0x69,
0x08,0x00,0x09,0x10,0x0A,0x00,
0x10,0x80,0x11,0xF4,0x12,0x80,0x13,0x80,0x14,0x80,0x15,0x80,0x16,0x80,0x17,0x80,
0x18,0x80,0x19,0x00,0x1A,0xE0,0x1B,0x38,0x1C,0x80,0x1D,0x00,0x1E,0x00,0x1F,0x00,
0x20,0x40,0x21,0x00,0x22,0x00,0x23,0x00,0x24,0x18,0x25,0x18,0x26,0x18,
0x30,0x20,0x31,0x63,0x32,0x00,0x33,0x15,0x34,0x00,0x35,0x47,0x36,0x00,0x37,0x04,
0x38,0x00,0x39,0x09,0x3A,0x00,0x3B,0x1E,0x3C,0x00,0x3D,0x11,0x3E,0x00,0x3F,0x17,
0x40,0x00,0x41,0x11,0x42,0x00,0x43,0x17,0x44,0x00,0x45,0xE5,0x46,0x00,0x47,0xE7,
0x48,0x00,0x49,0x00,0x4A,0x00,0x4B,0x00,0x4C,0x08,0x4D,0x00,0x4E,0x00,0x4F,0x06,
0x50,0x00,0x51,0x30,0x52,0x00,0x53,0x13,0x54,0x00,0x55,0x14,0x56,0x00,0x57,0x13,
0x58,0x00,0x59,0x14,0x5A,0x00,0x5B,0x01,0x5C,0x00,0x5D,0x32,0x5E,0x00,0x5F,0x01,
0x60,0xE0,0x61,0xB0,0x62,0x00,0x63,0x0F,0x64,0x00,0x65,0x31,0x66,0x00,0x67,0x01,
0x68,0x10,0x69,0x20,0x6A,0x00,0x6B,0x60,0x6C,0x00,0x6D,0xA0,0x6E,0x00,0x6F,0xF0,
0x70,0x00,0x71,0x0B,0x72,0x09,0x73,0x0B,0x74,0x9C,0x75,0x00,0x76,0x70,0x77,0x00,
0x78,0x8F,0x79,0x00,0x7A,0xA4,0x7B,0x00,0x7C,0x00,0x7D,0x40,0x7E,0x1D,0x7F,0x40,
0x80,0x06,0x81,0x00,0x82,0x10,0x83,0x00,0x84,0x13,0x85,0x00,0x86,0x00,0x87,0x00,
0x88,0x00,0x89,0x00,0x8A,0x57,0x8B,0x00,0x8C,0x00,0x8D,0x10,
#else
//register from MXIC Suzhou
0x00,0x99,0x01,0x07,0x02,0x03,
0x03,0x10,//MXIC : 0x65
0x04,0x00,//MXIC : 0x06
0x05,0x06,0x06,0xE7,0x07,0x69,
0x08,0x00,0x09,0x10,0x0A,0x00,0x0B,0x06,0x0C,0x06,0x0D,0x06,0x0E,0x06,0x0F,0x06,
0x10,0x00,0x11,0xF4,0x12,0x80,0x13,0x80,0x14,0x80,0x15,0x80,0x16,0x80,0x17,0x80,
0x18,0x80,0x19,0x00,0x1A,0xE0,0x1B,0x38,0x1C,0x80,0x1D,0x00,0x1E,0x00,0x1F,0x00,
0x20,0x40,0x21,0xff,0x22,0x00,0x23,0x00,0x24,0x18,0x25,0x18,0x26,0x18,0x27,0xf4,
0x28,0xf4,0x29,0xf4,0x2a,0xf4,0x2b,0xf4,0x2c,0xf4,0x2d,0xf4,0x2e,0xf4,0x2f,0xf4,
0x30,0x20,
0x31,0x46, //MXIC : 0x63,
0x32,0x00,0x33,0x15,0x34,0x00,0x35,0x47,0x36,0x00,0x37,0x04,
0x38,0x00,0x39,0x09,0x3A,0x00,0x3B,0x1E,0x3C,0x00,0x3D,0x11,0x3E,0x00,0x3F,0x17,
0x40,0x00,0x41,0x11,0x42,0x00,0x43,0x17,0x44,0x00,
0x45,0xc5, //MXIC :0xe5
0x46,0x00,0x47,0xE7,
0x48,0x00,0x49,0x00,0x4A,0x00,0x4B,0x00,0x4C,0x00,0x4D,0x00,0x4E,0x00,0x4F,0x06,
0x50,0x00,0x51,0x30,0x52,0x00,0x53,0x13,0x54,0x00,0x55,0x14,0x56,0x00,0x57,0x13,
0x58,0x00,0x59,0x14,0x5A,0x00,0x5B,0x01,0x5C,0x00,0x5D,0x32,0x5E,0x00,0x5F,0x01,
0x60,0xE0,0x61,0xB0,0x62,0x00,0x63,0x0F,0x64,0x00,0x65,0x31,0x66,0x00,0x67,0x01,
0x68,0x10,0x69,0x20,0x6A,0x00,0x6B,0x60,0x6C,0x00,0x6D,0xA0,0x6E,0x00,0x6F,0xF0,
0x70,0x00,0x71,0x0B,0x72,0x09,0x73,0x0B,0x74,0x9C,0x75,0x00,0x76,0x70,0x77,0x00,
0x78,0x8F,0x79,0x00,0x7A,0xA4,0x7B,0x00,0x7C,0x00,0x7D,0x40,0x7E,0x1D,0x7F,0x40,
0x80,0x06,0x81,0x00,0x82,0x10,0x83,0x00,0x84,0x13,0x85,0x00,0x86,0x00,0x87,0x00,
0x88,0x00,0x89,0x00,0x8A,0x57,0x8B,0x00,0x8C,0x00,0x8D,0x10,0x8E,0x10,0x8F,0x10,
#endif
0xFF,0xFF
};

BYTE v431_CCIR656_480x234reg[]=
{
#if 1 //AU 7"
0x00,0x99,0x01,0x07,0x02,0x04,0x03,0x22,0x04,0x00,0x05,0x06,0x06,0xE7,0x07,0x69,
0x08,0x00,0x09,0x10,0x0A,0x00,0x0B,0x08,0x0C,0x08,0x0D,0x08,0x0E,0x08,0x0F,0x08,
0x10,0x80,0x11,0xF0,0x12,0x78,0x13,0x78,0x14,0x78,0x15,0x70,0x16,0x70,0x17,0x70,
0x18,0x80,0x19,0x00,0x1A,0xE0,0x1B,0x4E,0x1C,0x00,0x1D,0x00,0x1E,0x00,0x1F,0x00,
0x20,0x40,0x21,0xFF,0x22,0x00,0x23,0x00,0x24,0x00,0x25,0x00,0x26,0x00,0x27,0x00,
0x28,0x00,0x29,0x00,0x2A,0x00,0x2B,0x00,0x2C,0x00,0x2D,0x00,0x2E,0x00,0x2F,0x00,
0x30,0x20,0x31,0x35,0x32,0x00,0x33,0x50,0x34,0x00,0x35,0xAB,0x36,0x00,0x37,0x04,
0x38,0x00,0x39,0x09,0x3A,0x00,0x3B,0x1E,0x3C,0x00,0x3D,0x11,0x3E,0x00,0x3F,0x17,
0x40,0x00,0x41,0x11,0x42,0x00,0x43,0x17,0x44,0x00,0x45,0xEA,0x46,0x00,0x47,0xED,
0x48,0x00,0x49,0x00,0x4A,0x00,0x4B,0x42,0x4C,0x08,0x4D,0x00,0x4E,0x00,0x4F,0x25,
0x50,0x00,0x51,0x30,0x52,0x00,0x53,0x13,0x54,0x00,0x55,0x14,0x56,0x00,0x57,0x13,
0x58,0x00,0x59,0x14,0x5A,0x00,0x5B,0x01,0x5C,0x00,0x5D,0x32,0x5E,0x00,0x5F,0x01,
0x60,0xE0,0x61,0xB0,0x62,0x00,0x63,0x0F,0x64,0x00,0x65,0x31,0x66,0x00,0x67,0x01,
0x68,0x10,0x69,0x20,0x6A,0x00,0x6B,0x60,0x6C,0x00,0x6D,0xA0,0x6E,0x00,0x6F,0xF0,
0x70,0x00,0x71,0x0B,0x72,0x09,0x73,0x0B,0x74,0x90,0x75,0x00,0x76,0x75,0x77,0x00,
0x78,0x00,0x79,0x00,0x7A,0x75,0x7B,0x00,0x7C,0x00,0x7D,0x00,0x7E,0x1D,0x7F,0x40,
0x80,0x06,0x81,0x00,0x82,0x10,0x83,0x00,0x84,0x13,0x85,0x00,0x86,0x00,0x87,0x00,
0x88,0x00,0x89,0x00,0x8A,0x80,0x8B,0x00,0x8C,0x00,0x8D,0x00,0x8E,0x00,0x8F,0x00,
0x90,0x40,0x91,0x00,0x92,0x00,0x93,0x00,0x94,0x00,0x95,0x00,0x96,0x00,0x97,0x00,
0x98,0x80,0x99,0xFF,0x9A,0x80,0x9B,0xFF,0x9C,0x80,0x9D,0xFF,0x9E,0x80,0x9F,0xFF,
0xA0,0x40,0xA1,0x00,0xA2,0x00,0xA3,0x00,0xA4,0x80,0xA5,0xFF,0xA6,0x80,0xA7,0xFF,
0xA8,0x00,0xA9,0x00,0xAA,0x00,0xAB,0x00,0xAC,0x80,0xAD,0xFF,0xAE,0x80,0xAF,0xFF,
0xB0,0x40,0xB1,0x00,0xB2,0x80,0xB3,0xFF,0xB4,0x00,0xB5,0x00,0xB6,0x80,0xB7,0xFF,
0xB8,0x00,0xB9,0x00,0xBA,0x80,0xBB,0xFF,0xBC,0x00,0xBD,0x00,0xBE,0x80,0xBF,0xFF,
0xC0,0x02,0xC1,0x00,0xC2,0x02,0xC3,0x02,0xC4,0x02,0xC5,0x02,0xC6,0x02,0xC7,0x02,
0xC8,0x02,0xC9,0x02,0xCA,0x02,0xCB,0x02,0xCC,0x02,0xCD,0x02,0xCE,0x02,0xCF,0x02,
0xD0,0x02,0xD1,0x02,0xD2,0x02,0xD3,0x02,0xD4,0x02,0xD5,0x02,0xD6,0x02,0xD7,0x02,
0xD8,0x02,0xD9,0x02,0xDA,0x02,0xDB,0x02,0xDC,0x02,0xDD,0x02,0xDE,0x02,0xDF,0x02,
0xE0,0x02,0xE1,0x02,0xE2,0x02,0xE3,0x02,0xE4,0x02,0xE5,0x02,0xE6,0x02,0xE7,0x02,
0xE8,0x02,0xE9,0x02,0xEA,0x02,0xEB,0x02,0xEC,0x02,0xED,0x02,0xEE,0x02,0xEF,0x02,
0xF0,0x02,0xF1,0x02,0xF2,0x02,0xF3,0x02,0xF4,0x02,0xF5,0x02,0xF6,0x02,0xF7,0x02,
0xF8,0x02,0xF9,0x02,0xFA,0x02,0xFB,0x02,0xFC,0x02,0xFD,0x02,0xFE,0x02,0xFF,0x02,
#endif
0xFF,0xFF};

BYTE v431_CCIR601reg[]=
{
0x00,0x03,0x01,0x07,0x02,0x03,0x03,0x90,0x04,0x02,0x05,0x14,0x06,0x01,0x07,0x10,0x08,0x00,0x09,0x10,0x0A,0x00,0x0B,0x02,0x0C,0x02,0x0D,0x02,0x0E,0x02,0x0F,0x02,
0x10,0x80,0x11,0xF0,0x12,0x80,0x13,0x80,0x14,0x80,0x15,0x80,0x16,0x80,0x17,0x80,0x18,0x80,0x19,0x00,0x1A,0xE0,0x1B,0x38,0x1C,0x00,0x1D,0x00,0x1E,0x00,0x1F,0x00,
0x20,0x40,0x21,0xFF,0x22,0x00,0x23,0x00,0x24,0x00,0x25,0x00,0x26,0x00,0x27,0xF0,0x28,0xF0,0x29,0xF0,0x2A,0xF0,0x2B,0xF0,0x2C,0xF0,0x2D,0xF0,0x2E,0xF0,0x2F,0xF0,
0x30,0x20,0x31,0x63,0x32,0x00,0x33,0x15,0x34,0x00,0x35,0x47,0x36,0x00,0x37,0x04,0x38,0x00,0x39,0x09,0x3A,0x00,0x3B,0x1E,0x3C,0x00,0x3D,0x11,0x3E,0x00,0x3F,0x17,
0x40,0x00,0x41,0x11,0x42,0x00,0x43,0x17,0x44,0x00,0x45,0xE5,0x46,0x00,0x47,0xE7,0x48,0x00,0x49,0x00,0x4A,0x00,0x4B,0x00,0x4C,0x08,0x4D,0x00,0x4E,0x00,0x4F,0x06,
0x50,0x00,0x51,0x30,0x52,0x00,0x53,0x13,0x54,0x00,0x55,0x14,0x56,0x00,0x57,0x13,0x58,0x00,0x59,0x14,0x5A,0x00,0x5B,0x01,0x5C,0x00,0x5D,0x32,0x5E,0x00,0x5F,0x01,
0x60,0xE0,0x61,0xB0,0x62,0x00,0x63,0x0F,0x64,0x00,0x65,0x31,0x66,0x00,0x67,0x01,0x68,0x10,0x69,0x20,0x6A,0x00,0x6B,0x60,0x6C,0x00,0x6D,0xA0,0x6E,0x00,0x6F,0xF0,
0x70,0x00,0x71,0x0B,0x72,0x09,0x73,0x0B,0x74,0x9C,0x75,0x00,0x76,0x70,0x77,0x00,0x78,0x8F,0x79,0x00,0x7A,0xA4,0x7B,0x00,0x7C,0x00,0x7D,0x00,0x7E,0x1D,0x7F,0x40,
0x80,0x06,0x81,0x00,0x82,0x10,0x83,0x00,0x84,0x13,0x85,0x00,0x86,0x00,0x87,0x00,0x88,0x00,0x89,0x00,0x8A,0x57,0x8B,0x00,0x8C,0x00,0x8D,0x00,0x8E,0x00,0x8F,0x00,
0x90,0x00,0x91,0x00,0x92,0x00,0x93,0x00,0x94,0xFF,0x95,0xFF,0x96,0x00,0x97,0x00,0x98,0xFF,0x99,0xFF,0x9A,0x00,0x9B,0x00,0x9C,0xFF,0x9D,0xFF,0x9E,0xFF,0x9F,0xFF,
0xA0,0xFF,0xA1,0xFF,0xA2,0xFF,0xA3,0xFF,0xA4,0xFF,0xA5,0xFF,0xA6,0x00,0xA7,0x00,0xA8,0xFF,0xA9,0xFF,0xAA,0x00,0xAB,0x00,0xAC,0x00,0xAD,0x00,0xAE,0x00,0xAF,0x00,
0xB0,0x00,0xB1,0x00,0xB2,0xFF,0xB3,0xFF,0xB4,0xFF,0xB5,0xFF,0xB6,0xFF,0xB7,0xFF,0xB8,0x00,0xB9,0x00,0xBA,0x00,0xBB,0x00,0xBC,0x00,0xBD,0x00,0xBE,0xFF,0xBF,0xFF,
0xC0,0x0A,0xC1,0x0A,0xC2,0x0A,0xC3,0x0A,0xC4,0x0A,0xC5,0x0A,0xC6,0x0A,0xC7,0x0A,0xC8,0x0A,0xC9,0x0A,0xCA,0x0A,0xCB,0x0A,0xCC,0x0A,0xCD,0x0A,0xCE,0x0A,0xCF,0x0A,
0xD0,0x0A,0xD1,0x0A,0xD2,0x0A,0xD3,0x0A,0xD4,0x0A,0xD5,0x0A,0xD6,0x0A,0xD7,0x0A,0xD8,0x0A,0xD9,0x0A,0xDA,0x0A,0xDB,0x0A,0xDC,0x0A,0xDD,0x0A,0xDE,0x0A,0xDF,0x0A,
0xE0,0x0A,0xE1,0x0A,0xE2,0x0A,0xE3,0x0A,0xE4,0x0A,0xE5,0x0A,0xE6,0x0A,0xE7,0x0A,0xE8,0x0A,0xE9,0x0A,0xEA,0x0A,0xEB,0x0A,0xEC,0x0A,0xED,0x0A,0xEE,0x0A,0xEF,0x0A,
0xF0,0x0A,0xF1,0x0A,0xF2,0x0A,0xF3,0x0A,0xF4,0x0A,0xF5,0x0A,0xF6,0x0A,0xF7,0x0A,0xF8,0x0A,0xF9,0x0A,0xFA,0x0A,0xFB,0x0A,0xFC,0x0A,0xFD,0x0A,0xFE,0x0A,0xFF,0x0A,
0xFF,0xFF};

#if 0
BYTE v431_LG_7inchreg[] = {
0x19, 0x03,	//tuning hue weight
0x1A, 0x00,
0x1B, 0x00,
0x21, 0x00,
0x7D, 0x40,	//depend on panel
0x8A, 0x57,	//remove yellow vertical line at right of panel
0x8B, 0x03,
0x8D, 0x11,	//depend on panel
};
#endif
BYTE v431_AU_6inchreg[] = {
0x02, 0x04,
0x03, 0x30,
0x04, 0x00,
0x07, 0x30,
0x1b, 0x4e,
0x1c, 0x00,
0x31, 0x2b,
0x53, 0x0d,
0x55, 0x0e,
0x57, 0x0d,
0x59, 0x0e,
0x7a, 0x04,
0x8a, 0x60,
};

//For 7"    panel 0x8A, 0x57
//For 5.6" panel 0x8A, 0x3A

BYTE v431_AU_5p6reg[] = {
0x8A, 0x3A,
0xFF, 0xFF,
};
//#define READ       1

#if (I2C_FUNCTION == I2C_HW_MASTER_MODE)
void MX88V431WtRegFromTable(BYTE DevID, BYTE * SettingTable)
{
	WORD TablePointer = 0, RegNumber = 0, RegValue = 0;

	RegNumber = *(SettingTable + TablePointer);
	RegValue = *(SettingTable + TablePointer + 1);
	while (!((RegNumber == 0xff) && (RegValue == 0xff)))
	{
		I2CM_WtReg1(DevID, RegNumber, RegValue);
		TablePointer += 2;
		RegNumber = *(SettingTable + TablePointer);
		RegValue = *(SettingTable + TablePointer + 1);
	}
}
#else
void MX88V431WtRegFromTable(BYTE DevID, BYTE * SettingTable)
{
    int i=0;
    BYTE mask, data1;
    register GPIO *sGpio;
    DWORD clkLow, clkHigh, dataLow, dataHigh;

    sGpio = (GPIO *) (GPIO_BASE);
    sGpio->Gpcfg0 &= 0xfffcfffc;  //1111 1111 1111 1100, default function
    sGpio->Gpdat0 |= 0x00030000;  // GP0, GP1 output

    do{
        // write
        IODelay(20);
        if(IIC_SetValue(IIC_WRITE_ID, START) == IIC_NO_ACK) UartOutText("NAK");// return IIC_NO_ACK;
        if(IIC_SetValue(*(SettingTable + i), IGNORE) == IIC_NO_ACK) UartOutText("NAK ");// return IIC_NO_ACK;
        if(IIC_SetValue(*(SettingTable + i + 1), STOP) == IIC_NO_ACK) UartOutText("NAK ");// return IIC_NO_ACK;

#ifdef READ
        IODelay(50);
        IIC_SetValue(IIC_WRITE_ID, START);
        IIC_SetValue(*(SettingTable + i), IGNORE);
        enterData(DATA_HIGH);
        IIC_SetValue(IIC_READ_ID, START);
        mask = IIC_GetValue();
        if (i<0xD0)
        {
            UartOutText("[");
            UartOutValue(*(SettingTable + i),2);
            UartOutText("]=");
            UartOutValue(mask, 2);
            UartOutText("   ");
        }
#endif
        i+= 2;
    }
    while(!((*(SettingTable + i) == 0xFF) && (*(SettingTable + i + 1) == 0xFF)));
}
#endif


void MX88V431Init()
{
    ST_PANEL *pstPanel = g_psSystemConfig->sScreenSetting.pstPanel;
    ST_SCREEN_TABLE *pstScreenTable = &g_mstScreenTable[g_psSystemConfig->sScreenSetting.bScreenIndex];
    BYTE bBusType, bInterlace, bPanelType;
    bBusType = g_psSystemConfig->sScreenSetting.pstCurTCON->bBusType;
    bInterlace = g_psSystemConfig->sScreenSetting.pstCurTCON->bInterlace;
    bPanelType = pstScreenTable->bPanelId;

#if ((STD_BOARD_VER == MP612PQFP_88V430_8M_SDRAM_0636MD04) ||  (STD_BOARD_VER == MP612PQFP_88V431_8M_SDRAM_0649MD05))//fengrs 02/14
        register GPIO *sGpio;
        sGpio = (GPIO *) (GPIO_BASE);

        sGpio->Gpcfg0 &= 0xfefffeff;
        sGpio->Gpdat0 |= 0x01000000;
        sGpio->Gpdat0 &= 0xfffffeff;
        IODelay (1000);
        sGpio->Gpdat0 |= 0x00000100;
        IODelay (1000);
#endif

        if(bBusType == DISP_TYPE_CCIR601){
        MX88V431WtRegFromTable(IIC_WRITE_ID, (BYTE *)(&v431_CCIR601reg));
        }
        else if(bBusType == DISP_TYPE_CCIR656){
            if (bInterlace == PROGRASSIVE){
                MX88V431WtRegFromTable(IIC_WRITE_ID, (BYTE *)(&v431_CCIR656_480x234reg));
	    }
            else //INTERLACE
            {
            	if(bPanelType == PANEL_LT070W02TMC4)
                MX88V431WtRegFromTable(IIC_WRITE_ID, (BYTE *)(&v431_CCIR656_LG_720x480reg));
                else
                MX88V431WtRegFromTable(IIC_WRITE_ID, (BYTE *)(&v431_CCIR656_720x480reg));

            	if(bPanelType == PANEL_AT056TN04)
            		MX88V431WtRegFromTable(IIC_WRITE_ID, (BYTE *)(&v431_AU_5p6reg));
            }
        }
        if(bPanelType == PANEL_A060FW02)
        MX88V431WtRegFromTable(IIC_WRITE_ID, (BYTE *)(&v431_AU_6inchreg));

        return;
}

#endif

